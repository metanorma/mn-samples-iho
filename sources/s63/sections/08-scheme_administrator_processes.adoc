
[[scheme_administrator_processes]]
== Scheme administrator processes

[[data_protection_scheme_administrator]]
=== Data Protection Scheme Administrator

The Data Protection Scheme Administrator (SA) is solely responsible for maintaining and coordinating the S-63 Data Protection Scheme (DPS). The SA role is operated by the IHO Secretariat on behalf of the IHO member states.

The SA is responsible for controlling membership of the scheme and ensuring that all participants operate according to defined procedures. The SA maintains top level encryption keys used to operate the complete scheme and is the only body that can issue certificates to other participants. The SA is the custodian of all documentation relating to the scheme.

[[scheme_administrator_processes_subsec]]
=== Scheme Administrator Processes

The main responsibilities of the IHO as the S-63 Scheme Administrator are depicted in the <<fig14>>. Each _"Process Box"_ cross references the particular section where these operations are outlined in more detail.

[[fig14]]
.Main Scheme Administrator Processes
image::image-14.png["","",""]

[[create_top_level_key_pair]]
=== Create Top Level Key Pair

The IHO as scheme administrator must create a top level public and private key pair. The private key will be used to sign Data Server certificates and the public key to authenticate the signature. The public key must be installed on the Data Clients system independently of the Encrypted ENC data.

[[create_pqg_parameters]]
==== Create PQG Parameters 

This procedure is normally performed by the SA and Data Servers during the creation of public/private key pairs. Although the PQG parameters generated by Data Servers do not need to be identical to those contained within the SA public key and the SA Digital Certificate, the key lengths used must be identical.

[[fig15]]
.Make Top Level Key Pair
image::image-15.png["","",""]

The PQG file only exists by itself for a short period during the creation of the X and Y files. After these have been made, the PQG file will be contained within the X and Y files.

The creation of appropriate PQG parameters is covered in more detail in the Digital Signature Standard (DSS) <<dss,[2]>>. For information relating to the format of the PQG file see <<pqg_format>>.

[[create_private_key]]
==== Create Private Key

The private key is an output of the key generation process. The private key must be stored securely and access limited to only those persons that have a need to know. Unauthorized possession of the SA's private key can potentially undermine the security of the authentication part of the scheme. The SA will issue a new public key (and corresponding SA certificate) if the private key is compromised. Details of the X file (Private Key) format are contained in <<the_x_format>>.

[[create_public_key]]
==== Create Public Key

The public key is an output of the key generation process. The public key is sent to all participants of the scheme in both a digital and a printed form. The two forms are to be sent by different means. Details of the Y file (Public Key) format are contained in <<the_y_format>>.

[[create_and_issue_sa_digital_certificate]]
=== Create and Issue SA Digital Certificate (X509v3)

The SA Digital Certificate will be compliant with X509v3 <<ITU-T_X.509,[4]>>. The SA Digital Certificate will always be provided in a file called IHO.CRT. The IHO.CRT file is available from IHO at https://iho.int/[www.iho.int].

The SA uses a DSA Public Key of length 512 bits.

All Data Servers providing an ENC service may include the SA certificate, for reference in the root directory of the media (e.g. in D:\IHO.CRT on a CD-ROM) but, as stated in <<data_management_introduction>>, the installation on a Data Client's system of the SA certificate should be done independently. The check of the validity of the SA signature within each ENC signature file must be done from the independently installed version of the SA certificate.

The SA public key (as opposed to the digital certificate) is also made available as an ASCII file on the IHO website at https://iho.int/[www.iho.int] (the format is described in Section 6.5).

[[update_sa_digital_certificate]]
==== Update SA X509v3 Digital Certificate (Public Key)

The SA will publish and make a new SA Digital Certificate available under the following circumstances:

* When the SA Digital Certificate expires. In this case the Certificate shall not contain a changed public key. 
* When the SA private key has been compromised. In this case a new public key shall be contained within the SA Digital Certificate.

The SA will publish its new Digital Certificate and, if applicable, a new printable version (ref section 6.5) of the public key on the IHO website (https://iho.int/[www.iho.int]). All Data Servers and Manufacturers will immediately be informed and will receive copies of the new Digital Certificate and, if applicable, the new public key in printable format.

The Data Server and Manufacturers are collectively responsible for informing their Data Clients of any new SA Digital Certificate and, if applicable, any new SA public key.

This procedure is normally performed by all users of the protection scheme when a new SA Digital Certificate or public key is issued and is performed as follows:

* Obtain the new SA Digital Certificate and printable SA public key from the IHO website (https://iho.int/[www.iho.int]) 
* The application shall load the new SA Digital Certificate and check the public key and the printable public key are identical. Only when this has been done is the application to assume that the SA public key is correct. This same process is applied to the replacement of the original SA public key.
* Replace the existing SA Digital Certificate with the newly issued certificate.

[[process_applications_from_data_servers_oems]]
=== Process Applications from Data Servers & OEMs

The Scheme Administrator is responsible for processing applications from Data Servers and OEMs who wish to subscribe to the IHO S-63 ENC Data Protection Scheme. This includes the management and issuing SA Signed certificates to Data Servers and the management and issuing of Manufacturer Codes (M_ID & M_KEY) to accepted OEMs and their distribution to authorised Data Servers. The application processes are outlined in more detail at *ANNEX A* & *ANNEX B* of this document.

[[process_data_server_request_for_data_server_certficate]]
==== Process Data Server Request for Data Server Certificate

A successful Data Server applicant will be required to supply a certificate signed with the Data Server private key, this is known as Self Signed Key (SSK). The certification process is then carried out by the SA and is detailed step by step below.

[[authenticate_ssk_file]]
===== Authenticate Self Signed Key (SSK) File

The SA authenticates the Data Server SSK file before creating and issuing a Data Server Certificate. Initially the SA should confirm that the SSK has been supplied in the correct format as described in <<the_ssk_format>>, if incorrect the process should be terminated and a warning given. If correct the process to authenticate should proceed as follows:

[type=a]
. Extract the signature elements 'R' and 'S' (i.e. the first two data strings and their attendant headers from the SSK file supplied by the Data Server). This leaves a public key file.
. Hash the public key file using the algorithm SHA-1. All bytes within the file are to be hashed.
. Verify the signature (the elements removed at 'a' above) by passing it, together with the public key file and the hash of the public key file (as obtained at 'b' above) to the DSA. This will return a status (correct or incorrect). 

If the signature verifies correctly, the SA can produce the Data Server Certificate.

[[create_data_server_certificate]]
===== Create Data Server Certificate

The SA creates a Data Server Certificate after the SSK has been authenticated. The details of the digital signature algorithm DSA are covered in the publication FIPS 186 Digital Signature Standard (DSS). The procedure is as follows:

[type=a]
. Discard the signature elements (i.e. the first two data strings and their attendant headers) from the self signed key file. This leaves a public key file. 
. Hash the public key file using the algorithm SHA-1. All bytes within the file are to be hashed.
. Sign the public key file (as hashed at 'b' above) by passing the SA private key, the hash of the public key file (as obtained at 'b' above) and a random string to the DSA. This will return the two signature elements ('R' and 'S'). 
. Write these to the certificate file and append the public key file (as left at 'a' above) to form the certificate. 

[[authenticate_sa_signed_data_server_certificate]]
===== Authenticate SA signed Data Server Certificate

The SA confirms the newly signed certificate is valid before despatching it to the Data Server. The procedure is as follows:

[type=a]
. Extract the signature elements (i.e. the first two data strings and their attendant headers) from the newly created DS certificate file. This leaves the DS's public key file. 
. Hash the DS public key file (obtained from 'a') using the algorithm SHA-1. All bytes within the file are to be hashed.
. Verify the signature elements (as removed at 'a' above) by passing it, together with the SA public key and the hash of the DS public key file (as obtained at 'b' above) to the DSA. This will return a status (correct or incorrect).

If the DS Certificate authenticates correctly, it can be sent to the DS and used in the construction of ENC digital signatures.

[[fig16]]
[%unnumbered]
image::image-16.png["","",""] 

[[manage_data_server_certificates]]
===== Manage Data Server Certificates

When a new SA signed Data Server Certificate has been issued to a Data Server it should be stored securely in a certificate store. The certificate should be uniquely assigned to the Data Server and cross referenced to the private key used to sign it and the public key used to confirm authentication.

[[process_oem_application]]
==== Process OEM Application

Manufacturers must apply to the SA to become a member of the IHO S-63 Data Protection Scheme.

[[issue_and_manage_s63_manufacturer_codes]]
===== Issue and Manage S-63 Manufacturer Codes

Successful OEM applicants will be supplied with their own unique Manufacturer ID (M_ID) and Manufacturer Key (M_KEY) see <<m_id_format>> and <<m_key_format>>. These codes must be stored securely together with the manufacturers contact details and whether they are still an active participant in the scheme.

[[issue_mid_and_mkey_listings_to_data_servers]]
===== Issue M_ID and M_KEY listings to Data Servers

Data Servers require the M_ID and M_KEY values so that they can identify a specific manufacturer and derive the correct M_KEY for extracting the Data Clients HW_ID from the userpermit. The SA will supply Data Servers with a complete list of codes for all approved manufacturers of S-63 compliant systems. This list will be supplied in a protected form every time a manufacturer is added to the list or if the status of a manufacturer changes, e.g. membership of the scheme revoked.

[[s63_test_data]]
=== S-63 Test Data

The S-63 data protection scheme is supported by a comprehensive set of test data, see S‑63 Appendix 1 - Data Protection Scheme Test Data.

[[scheme_administrator_security_qa_procedures]]
=== Scheme Administrator – Security QA Procedures

[[scheme_administrator_documentation]]
==== Documentation

The SA shall hold the documentation for the Data Protection Scheme. This shall be held under change control procedure and the SA shall inform all participants (Data Servers and developers of Data Client applications) of the Data Protection Scheme, of changes to the standard.

Test data for the Data Protection Scheme and a software kernel are also available for system manufacturers to test their implementation for full compliance. The test data and software kernel are described in Appendix A and B and obtainable from the IHO website (https://iho.int/[www.iho.int]).

[[administration_of_confidentiality_agreement]]
==== Administration of Confidentiality Agreement

All details required to operate the security scheme and all proprietary information (e.g. M_KEY) will be provided to interested parties under cover of a Confidentiality Agreement. The SA shall be responsible for administering this agreement. The Confidentiality Agreement will limit the possibilities for participants to breach the Data Protection Scheme.

[[audit_of_security_registers]]
==== Audit of Security Registers

The SA shall have the ability to audit all security registers maintained by the participants of the Data Protection Scheme. The content of these registers are defined in <<store_self_signed_key>>, <<store_sa_signed_data_server_certificate>>, <<sec_storage_of_mids_and_mkeys>> and <<qa_storage_of_mids_and_mkeys>>. The SA shall audit these registers to confirm that they are complete and up-to-date. Any problems must be corrected immediately or the participant shall become non-compliant and optionally may be withdrawn from the protection scheme.

[[creation_of_mids_and_mkeys]]
==== Creation of M_IDs and M_KEYs

The SA shall be responsible for creating and issuing the M_ID and M_KEY values used within the Data Protection Scheme. The SA shall record, in a M_ID / M_KEY Register all M_ID/M_KEY values and which organisations have received which values. The SA will ensure that no duplicate values are created.

The SA will provide information to all Data Servers in the protection scheme on amendments to M_ID and M_KEY values.

[[creation_of_dsk]]
==== Creation of Digital Signature Keys (Private and Public Keys)

The SA shall have the ability to create a private and public key pair. The private key is used in the certificate signing process and the public key in the signature authentication process.

The private key must be stored securely and access to it limited to only those persons that have a "need to know". The SA will issue a new public key (and corresponding SA certificate) if the current private key is compromised.

The SA public key should be made available to all participants of the S-63 Data Protection Scheme in both digital and printed forms, e.g. fax and downloadable from a website. The two formats are to be sent or made available by different methods.

[[acceptance_of_ssk]]
==== Acceptance of Self Signed Keys (SSK)

The SA shall confirm that any self signed key provided by a Data Server is bona-fide by contacting the originating organisation. This can be done either by phone, fax or mail but the origins must be confirmed to the Scheme Administrator's satisfaction before the DS certificate is signed by the SA using the self signed key. The SA is to record all SSKs received in a SSK Register.

[[creation_of_ds_certificates]]
==== Creation of Data Server (DS) Certificates

The SA shall be able to create SA signed DS Certificates from the self signed keys provided by a DS and the SA private key. The signed certificate should be authenticated against the DS public key before being sent to the DS. The SA shall keep a record of all DS certificates in a DS Certificate Register.

The DS will be required to sign a Confidentiality Agreement before the SA will issue the DS Certificate. The SA will provide information to all participants of the protection scheme on any revoked Data Server Certificates.

[[creation_of_random_strings]]
==== Creation of Random Strings

In order to sign data (required as part of the certificate creation), the SA will have to create random strings. The SA shall ensure that the same value is not used for any two separate signings. Although it is not possible to guarantee this if the strings are generated randomly. However, the chance of the same string being generated twice is extremely small.

[[handover_of_mid_and_mkey]]
==== Handover of M_ID and M_KEY

When a system manufacturer completes their internal compliance testing, they will be required to sign a Confidentiality Agreement before the SA will issue the M_ID and M_KEY.

[[fig17]]
.Scheme Administrator (SA) - SSK Authentication & Certificate Signing Process
image::image-17.png["","",""]